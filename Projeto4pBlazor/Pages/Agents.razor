@page "/Agents"
@inject HttpClient Http
@using Projeto4pServer.DTOs

<main>
    <div class="flex flex-wrap justify-center bg-black text-white min-h-screen p-4">
        @if (characters == null)
        {
            <p>Loading agents...</p>
        }
        else if (!characters.Any())
        {
            <p>No agents found.</p>
        }
        else
        {
            @foreach (var character in characters)
            {
                <div class="bg-neutral-800 rounded-lg shadow-lg p-4 m-4 w-64">
                    <h2 class="text-xl font-bold text-purple-400">@character.Name</h2>
                    <p><strong>Age:</strong> @character.CAT</p>
                    @if (character.CharBlasphemies != null && character.CharBlasphemies.Any())
                    {
                        <p><strong>Blasphemy:</strong> @character.CharBlasphemies.First().Blasphemy.Name</p>
                    }
                    @if (character.CharAgendas != null && character.CharAgendas.Any())
                    {
                        <p><strong>Agenda:</strong> @character.CharAgendas.First().Agenda.Name</p>
                    }
                </div>
            }
        }
    </div>
</main>

@code {
    private List<CharacterDto>? characters;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            // Substitua "api/Character" pela rota correta da sua API para buscar os characters do usu√°rio
            characters = await Http.GetFromJsonAsync<List<CharacterDto>>("api/Character");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error fetching characters: {ex.Message}");
        }
    }
}